description: Refactoring of the table-tennis workflow using subgraphs for organization.
schema: |-
  {
    "type": "object",
    "properties": {
      "ping": {
        "type": "number"
      },
      "pong": {
        "type": "number"
      }
    },
    "oneOf": [
      {
        "required": [
          "ping"
        ]
      },
      {
        "required": [
          "pong"
        ]
      }
    ]
  }
chain:
- table-tennis-sg
uuid: ae93ab94-ac67-4f3c-b24a-d3364bfc6490
nodes:
  0:
    value:
      Start: {}
    pos:
      x: 40.099857
      y: 57.86646
    open: true
  1:
    value:
      Finish: {}
    pos:
      x: 44.876534
      y: 425.48828
    open: true
  2:
    value:
      OutputNode:
        label: next-args
    pos:
      x: 2057.615
      y: 819.5332
    open: true
  3:
    value:
      Subgraph:
        title: Subgraph
        graph:
          uuid: ceeb3b45-2b06-430f-bc34-bac14b8a628b
          nodes:
            0:
              value:
                Start:
                  fields:
                  - - key
                    - Json
                  - - data
                    - Json
              pos:
                x: -31.135223
                y: 11.914485
              open: true
            1:
              value:
                Finish:
                  fields:
                  - - workflow
                    - Text
                  - - args
                    - Json
              pos:
                x: 2523.6797
                y: -98.72954
              open: true
            2:
              value:
                Text:
                  value: table-tennis-sg
                  size:
                    x: 300.0
                    y: 150.0
              pos:
                x: 1560.2992
                y: -1079.2233
              open: true
            3:
              value:
                Matcher:
                  kind: Json
                  patterns:
                  - ping
                  - pong
                  exact: true
              pos:
                x: 344.5139
                y: 11.107621
              open: true
            4:
              value:
                Panic: {}
              pos:
                x: 625.21063
                y: 685.18933
              open: true
            5:
              value:
                TransformJson:
                  filter: '{"pong": (.ping // 0) + 1}'
                  size:
                    x: 300.0
                    y: 150.0
              pos:
                x: 1565.2421
                y: -38.48578
              open: true
            6:
              value:
                TransformJson:
                  filter: '{"ping": (.pong // 0) + 1}'
                  size:
                    x: 300.0
                    y: 150.0
              pos:
                x: 1560.9666
                y: 332.35745
              open: true
            7:
              value:
                Text:
                  value: table-tennis-sg
                  size:
                    x: 300.0
                    y: 150.0
              pos:
                x: 1562.6094
                y: -751.79663
              open: true
            8:
              value:
                Select:
                  count: 3
                  kind: Text
              pos:
                x: 2068.7534
                y: -590.6039
              open: true
            9:
              value:
                Select:
                  count: 3
                  kind: Json
              pos:
                x: 2232.2144
                y: 268.40335
              open: true
            10:
              value:
                TransformJson:
                  filter: .pong
                  size:
                    x: 160.0
                    y: 64.0
              pos:
                x: 685.0865
                y: 375.56656
              open: true
            11:
              value:
                Matcher:
                  kind: Json
                  patterns:
                  - 0..=4
              pos:
                x: 1136.2461
                y: 232.49548
              open: true
            13:
              value:
                CommentNode:
                  comment: |-
                    Conditionally, define the next workflow.
                    These could call different workflows
                  size:
                    x: 300.0
                    y: 150.0
              pos:
                x: 2068.788
                y: -892.4019
              open: true
            14:
              value:
                ParseJson:
                  text: ''
                  size:
                    x: 300.0
                    y: 150.0
              pos:
                x: 1799.3737
                y: 774.89044
              open: true
            15:
              value:
                Text:
                  value: __break__
                  size:
                    x: 300.0
                    y: 150.0
              pos:
                x: 1566.5305
                y: -399.25046
              open: true
            16:
              value:
                Text:
                  value: '"Done"'
                  size:
                    x: 300.0
                    y: 150.0
              pos:
                x: 1408.7715
                y: 731.6915
              open: true
          wires:
          - out_pin:
              node: 0
              output: 0
            in_pin:
              node: 3
              input: 0
          - out_pin:
              node: 0
              output: 1
            in_pin:
              node: 3
              input: 1
          - out_pin:
              node: 2
              output: 0
            in_pin:
              node: 8
              input: 0
          - out_pin:
              node: 3
              output: 0
            in_pin:
              node: 2
              input: 0
          - out_pin:
              node: 3
              output: 0
            in_pin:
              node: 5
              input: 1
          - out_pin:
              node: 3
              output: 1
            in_pin:
              node: 10
              input: 1
          - out_pin:
              node: 3
              output: 1
            in_pin:
              node: 11
              input: 1
          - out_pin:
              node: 3
              output: 2
            in_pin:
              node: 4
              input: 0
          - out_pin:
              node: 5
              output: 0
            in_pin:
              node: 9
              input: 0
          - out_pin:
              node: 6
              output: 0
            in_pin:
              node: 9
              input: 1
          - out_pin:
              node: 7
              output: 0
            in_pin:
              node: 8
              input: 1
          - out_pin:
              node: 8
              output: 0
            in_pin:
              node: 1
              input: 0
          - out_pin:
              node: 9
              output: 0
            in_pin:
              node: 1
              input: 1
          - out_pin:
              node: 10
              output: 0
            in_pin:
              node: 11
              input: 0
          - out_pin:
              node: 11
              output: 0
            in_pin:
              node: 6
              input: 1
          - out_pin:
              node: 11
              output: 0
            in_pin:
              node: 7
              input: 0
          - out_pin:
              node: 11
              output: 1
            in_pin:
              node: 15
              input: 0
          - out_pin:
              node: 11
              output: 1
            in_pin:
              node: 16
              input: 0
          - out_pin:
              node: 14
              output: 0
            in_pin:
              node: 9
              input: 2
          - out_pin:
              node: 15
              output: 0
            in_pin:
              node: 8
              input: 2
          - out_pin:
              node: 16
              output: 0
            in_pin:
              node: 14
              input: 0
          start: 0
          finish: 1
    pos:
      x: 1569.2466
      y: 508.54517
    open: true
  4:
    value:
      OutputNode:
        label: prev-args
    pos:
      x: 338.65112
      y: 808.9169
    open: true
  5:
    value:
      Subgraph:
        title: Counterexamples
        graph:
          uuid: 51b42d0d-081c-4e9d-aacd-2380353d5dbe
          nodes:
            0:
              value:
                Start:
                  fields:
                  - - data
                    - Json
              pos:
                x: -720.43036
                y: -182.40154
              open: true
            1:
              value:
                Finish:
                  fields:
                  - - output
                    - Json
              pos:
                x: 1279.3782
                y: -388.33383
              open: true
            2:
              value:
                Subgraph:
                  title: Won't finish
                  graph:
                    uuid: a7dcaf79-14a3-4962-bb00-4bbdf95a71d5
                    nodes:
                      0:
                        value:
                          Start:
                            fields:
                            - - key
                              - Json
                            - - input
                              - Json
                        pos:
                          x: -430.5202
                          y: 271.34286
                        open: true
                      1:
                        value:
                          Finish:
                            fields:
                            - - pong
                              - Json
                            - - ping
                              - Json
                            - - stop
                              - Json
                        pos:
                          x: 1973.7543
                          y: 589.1917
                        open: true
                      2:
                        value:
                          Matcher:
                            kind: Json
                            patterns:
                            - ping
                            - pong
                            exact: true
                        pos:
                          x: -73.09923
                          y: 277.66718
                        open: true
                      3:
                        value:
                          Panic: {}
                        pos:
                          x: 389.69012
                          y: 1009.42236
                        open: true
                      4:
                        value:
                          TransformJson:
                            filter: '{"pong": (.ping // 0) + 1}'
                            size:
                              x: 300.0
                              y: 150.0
                        pos:
                          x: 1253.4645
                          y: 227.2987
                        open: true
                      5:
                        value:
                          TransformJson:
                            filter: '{"ping": (.pong // 0) + 1}'
                            size:
                              x: 160.0
                              y: 64.0
                        pos:
                          x: 1249.1891
                          y: 598.14154
                        open: true
                      7:
                        value:
                          TransformJson:
                            filter: .pong
                            size:
                              x: 162.0
                              y: 64.0
                        pos:
                          x: 431.86597
                          y: 608.11005
                        open: true
                      8:
                        value:
                          Matcher:
                            kind: Json
                            patterns:
                            - 0..=4
                        pos:
                          x: 824.4683
                          y: 498.2799
                        open: true
                      9:
                        value:
                          ParseJson:
                            text: ''
                            size:
                              x: 300.0
                              y: 150.0
                        pos:
                          x: 1487.5966
                          y: 1040.6743
                        open: true
                      10:
                        value:
                          Text:
                            value: '"Done"'
                            size:
                              x: 300.0
                              y: 150.0
                        pos:
                          x: 1096.9941
                          y: 997.4754
                        open: true
                    wires:
                    - out_pin:
                        node: 0
                        output: 0
                      in_pin:
                        node: 2
                        input: 0
                    - out_pin:
                        node: 0
                        output: 1
                      in_pin:
                        node: 2
                        input: 1
                    - out_pin:
                        node: 2
                        output: 0
                      in_pin:
                        node: 4
                        input: 1
                    - out_pin:
                        node: 2
                        output: 1
                      in_pin:
                        node: 7
                        input: 1
                    - out_pin:
                        node: 2
                        output: 1
                      in_pin:
                        node: 8
                        input: 1
                    - out_pin:
                        node: 2
                        output: 2
                      in_pin:
                        node: 3
                        input: 0
                    - out_pin:
                        node: 4
                        output: 0
                      in_pin:
                        node: 1
                        input: 0
                    - out_pin:
                        node: 5
                        output: 0
                      in_pin:
                        node: 1
                        input: 1
                    - out_pin:
                        node: 7
                        output: 0
                      in_pin:
                        node: 8
                        input: 0
                    - out_pin:
                        node: 8
                        output: 0
                      in_pin:
                        node: 5
                        input: 1
                    - out_pin:
                        node: 8
                        output: 1
                      in_pin:
                        node: 10
                        input: 0
                    - out_pin:
                        node: 9
                        output: 0
                      in_pin:
                        node: 1
                        input: 2
                    - out_pin:
                        node: 10
                        output: 0
                      in_pin:
                        node: 9
                        input: 0
                    start: 0
                    finish: 1
              pos:
                x: 288.3996
                y: 154.30754
              open: true
            3:
              value:
                Matcher:
                  kind: Json
                  patterns:
                  - ping
                  - pong
                  exact: true
              pos:
                x: 297.96942
                y: -359.26395
              open: true
            4:
              value:
                Panic: {}
              pos:
                x: 730.98596
                y: -146.65823
              open: true
            5:
              value:
                TransformJson:
                  filter: first(keys[] | select( . == "ping" or . == "pong"))
                  size:
                    x: 305.0
                    y: 150.0
              pos:
                x: -264.9178
                y: -549.72876
              open: true
            16:
              value:
                CommentNode:
                  comment: |
                    These will subgraph is show what to avoid
                  size:
                    x: 300.0
                    y: 150.0
              pos:
                x: -746.51776
                y: -696.33
              open: true
            17:
              value:
                Subgraph:
                  title: Won't start
                  graph:
                    uuid: 1cf6dc63-8330-42c3-a73c-c83d6831057a
                    nodes:
                      0:
                        value:
                          Start:
                            fields:
                            - - ping
                              - Json
                            - - pong
                              - Json
                        pos:
                          x: 26.270134
                          y: 79.735825
                        open: true
                      1:
                        value:
                          Finish:
                            fields:
                            - - output
                              - Json
                        pos:
                          x: 2218.7952
                          y: 638.57007
                        open: true
                      4:
                        value:
                          TransformJson:
                            filter: '{"pong": (.ping // 0) + 1}'
                            size:
                              x: 300.0
                              y: 150.0
                        pos:
                          x: 1219.1879
                          y: 218.58833
                        open: true
                      5:
                        value:
                          TransformJson:
                            filter: '{"ping": (.pong // 0) + 1}'
                            size:
                              x: 300.0
                              y: 150.0
                        pos:
                          x: 1214.9125
                          y: 589.43146
                        open: true
                      6:
                        value:
                          Select:
                            count: 3
                            kind: Json
                        pos:
                          x: 1886.159
                          y: 525.4777
                        open: true
                      7:
                        value:
                          TransformJson:
                            filter: .pong
                            size:
                              x: 160.0
                              y: 64.0
                        pos:
                          x: 304.34283
                          y: 567.3496
                        open: true
                      8:
                        value:
                          Matcher:
                            kind: Json
                            patterns:
                            - 0..=4
                        pos:
                          x: 729.1603
                          y: 450.73187
                        open: true
                      9:
                        value:
                          ParseJson:
                            text: ''
                            size:
                              x: 300.0
                              y: 150.0
                        pos:
                          x: 1453.3197
                          y: 1031.9644
                        open: true
                      10:
                        value:
                          Text:
                            value: '"Done"'
                            size:
                              x: 300.0
                              y: 150.0
                        pos:
                          x: 1062.7174
                          y: 988.7655
                        open: true
                    wires:
                    - out_pin:
                        node: 0
                        output: 0
                      in_pin:
                        node: 4
                        input: 1
                    - out_pin:
                        node: 0
                        output: 1
                      in_pin:
                        node: 7
                        input: 1
                    - out_pin:
                        node: 0
                        output: 1
                      in_pin:
                        node: 8
                        input: 1
                    - out_pin:
                        node: 4
                        output: 0
                      in_pin:
                        node: 6
                        input: 0
                    - out_pin:
                        node: 5
                        output: 0
                      in_pin:
                        node: 6
                        input: 1
                    - out_pin:
                        node: 6
                        output: 0
                      in_pin:
                        node: 1
                        input: 0
                    - out_pin:
                        node: 7
                        output: 0
                      in_pin:
                        node: 8
                        input: 0
                    - out_pin:
                        node: 8
                        output: 0
                      in_pin:
                        node: 5
                        input: 1
                    - out_pin:
                        node: 8
                        output: 1
                      in_pin:
                        node: 10
                        input: 0
                    - out_pin:
                        node: 9
                        output: 0
                      in_pin:
                        node: 6
                        input: 2
                    - out_pin:
                        node: 10
                        output: 0
                      in_pin:
                        node: 9
                        input: 0
                    start: 0
                    finish: 1
              pos:
                x: 693.9643
                y: -597.09906
              open: true
          wires:
          - out_pin:
              node: 0
              output: 0
            in_pin:
              node: 2
              input: 1
          - out_pin:
              node: 0
              output: 0
            in_pin:
              node: 3
              input: 1
          - out_pin:
              node: 0
              output: 0
            in_pin:
              node: 5
              input: 1
          - out_pin:
              node: 3
              output: 0
            in_pin:
              node: 17
              input: 0
          - out_pin:
              node: 3
              output: 1
            in_pin:
              node: 17
              input: 1
          - out_pin:
              node: 3
              output: 2
            in_pin:
              node: 4
              input: 0
          - out_pin:
              node: 5
              output: 0
            in_pin:
              node: 2
              input: 0
          - out_pin:
              node: 5
              output: 0
            in_pin:
              node: 3
              input: 0
          - out_pin:
              node: 17
              output: 0
            in_pin:
              node: 1
              input: 0
          start: 0
          finish: 1
    pos:
      x: 1121.4036
      y: 916.41815
    open: true
  6:
    value:
      Preview:
        size:
          x: 300.0
          y: 150.0
        uuid: eff59fb4-c2cd-4c84-9d3c-2507f56e1d5d
    pos:
      x: 2042.168
      y: 1106.6804
    open: true
  9:
    value:
      TransformJson:
        filter: first(keys[] | select( . == "ping" or . == "pong"))
        size:
          x: 300.0
          y: 150.0
    pos:
      x: 1087.663
      y: 250.20078
    open: true
  16:
    value:
      InvokeTool:
        tool_name: chainpong
    pos:
      x: 2076.0627
      y: 142.25693
    open: true
  17:
    value:
      Tools:
        toolset:
        - chainer/__break__
        - chainer/table-tennis-sg
        size:
          x: 250.0
          y: 250.0
    pos:
      x: 1677.751
      y: -298.72202
    open: true
  19:
    value:
      Subgraph:
        title: Extract input
        graph:
          uuid: 760210bb-2ff5-41fd-a6c4-8c9403b31986
          nodes:
            0:
              value:
                Start:
                  fields:
                  - - schema
                    - Json
                  - - input
                    - Text
              pos:
                x: 0.0
                y: 0.0
              open: true
            1:
              value:
                Finish:
                  fields:
                  - - output
                    - Json
              pos:
                x: 2159.2795
                y: 62.90612
              open: true
            2:
              value:
                Fallback:
                  kinds:
                  - Json
              pos:
                x: 1496.0948
                y: 507.09616
              open: true
            3:
              value:
                ParseJson:
                  text: '{"ping": 0 }'
                  size:
                    x: 300.0
                    y: 150.0
              pos:
                x: 422.61502
                y: 344.33173
              open: true
            4:
              value:
                ValidateJson:
                  size:
                    x: 504.0
                    y: 330.03125
              pos:
                x: 839.33325
                y: -120.70761
              open: true
            5:
              value:
                Select:
                  count: 3
                  kind: Json
              pos:
                x: 1866.8822
                y: -48.71176
              open: true
            6:
              value:
                CommentNode:
                  comment: Provide a default, if prompt does not conform to schema
                  size:
                    x: 300.0
                    y: 150.0
              pos:
                x: 1642.0388
                y: 723.03253
              open: true
            7:
              value:
                ParseJson:
                  text: ''
                  size:
                    x: 300.0
                    y: 150.0
              pos:
                x: 414.376
                y: 86.35454
              open: true
            8:
              value:
                Fallback:
                  kinds:
                  - Json
              pos:
                x: 964.9228
                y: 190.62834
              open: true
          wires:
          - out_pin:
              node: 0
              output: 0
            in_pin:
              node: 4
              input: 0
          - out_pin:
              node: 0
              output: 1
            in_pin:
              node: 7
              input: 0
          - out_pin:
              node: 2
              output: 0
            in_pin:
              node: 5
              input: 2
          - out_pin:
              node: 3
              output: 0
            in_pin:
              node: 2
              input: 1
          - out_pin:
              node: 3
              output: 0
            in_pin:
              node: 8
              input: 1
          - out_pin:
              node: 4
              output: 0
            in_pin:
              node: 5
              input: 0
          - out_pin:
              node: 4
              output: 1
            in_pin:
              node: 2
              input: 0
          - out_pin:
              node: 5
              output: 0
            in_pin:
              node: 1
              input: 0
          - out_pin:
              node: 7
              output: 0
            in_pin:
              node: 4
              input: 1
          - out_pin:
              node: 7
              output: 1
            in_pin:
              node: 8
              input: 0
          - out_pin:
              node: 8
              output: 0
            in_pin:
              node: 5
              input: 1
          start: 0
          finish: 1
    pos:
      x: 631.11945
      y: 326.79425
    open: true
  21:
    value:
      Preview:
        size:
          x: 300.0
          y: 150.0
        uuid: c1f1c997-69eb-4104-9c67-545a63043c31
    pos:
      x: 2509.2178
      y: 363.0471
    open: true
wires:
- out_pin:
    node: 0
    output: 2
  in_pin:
    node: 16
    input: 0
- out_pin:
    node: 0
    output: 3
  in_pin:
    node: 19
    input: 0
- out_pin:
    node: 0
    output: 4
  in_pin:
    node: 4
    input: 0
- out_pin:
    node: 0
    output: 4
  in_pin:
    node: 19
    input: 1
- out_pin:
    node: 3
    output: 0
  in_pin:
    node: 16
    input: 2
- out_pin:
    node: 3
    output: 1
  in_pin:
    node: 2
    input: 0
- out_pin:
    node: 3
    output: 1
  in_pin:
    node: 6
    input: 0
- out_pin:
    node: 3
    output: 1
  in_pin:
    node: 16
    input: 3
- out_pin:
    node: 9
    output: 0
  in_pin:
    node: 3
    input: 0
- out_pin:
    node: 16
    output: 2
  in_pin:
    node: 21
    input: 0
- out_pin:
    node: 17
    output: 0
  in_pin:
    node: 16
    input: 1
- out_pin:
    node: 19
    output: 0
  in_pin:
    node: 3
    input: 1
- out_pin:
    node: 19
    output: 0
  in_pin:
    node: 5
    input: 0
- out_pin:
    node: 19
    output: 0
  in_pin:
    node: 9
    input: 1
disabled:
- 5
start: 0
finish: 1
